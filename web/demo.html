<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VhPlyr Demo - L·ªõp h·ªçc tr·ª±c tuy·∫øn</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#FF6B35',
                        'primary-dark': '#E55A28',
                        surface: '#1A1A2E',
                        'surface-light': '#252540',
                    }
                }
            }
        }
</script>
</head>
<body class="bg-[#0F0F1A] text-white min-h-screen font-sans">

    <!-- Header -->
    <header class="bg-surface px-6 py-3 flex items-center justify-between border-b border-white/10">
        <div class="flex items-center gap-3 font-bold text-xl">
            <img src="https://xcdn-cf.vuihoc.vn/theme/vuihoc/imgs/vuihoc_logo_final.png" alt="VUIHOC" class="h-9">
        </div>
        <div class="flex items-center gap-4">
            <div class="flex items-center gap-2 bg-red-500/20 text-red-500 px-3 py-1.5 rounded-full text-xs font-semibold">
                <span class="w-2 h-2 bg-red-500 rounded-full animate-pulse-live"></span>
                LIVE
            </div>
            <span class="text-white/60 text-sm">L·ªõp h·ªçc Demo</span>
        </div>
    </header>

    <!-- Main -->
    <main class="grid grid-cols-1 lg:grid-cols-[1fr_320px] gap-5 p-5 max-w-7xl mx-auto">
        <div class="flex flex-col gap-4">
            <!-- Player -->
            <div class="bg-black rounded-xl overflow-hidden aspect-video">
                <iframe id="player-iframe"
                    src="https://vuihoc-edtech.github.io/vh_plyr/?url=https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8"
                    class="w-full h-full border-none"
                    allowfullscreen allow="autoplay; fullscreen; picture-in-picture">
                </iframe>
            </div>

            <!-- URL Input -->
            <div class="bg-surface rounded-xl p-4">
                <label class="block text-xs text-white/60 uppercase tracking-wide mb-2">Stream URL (HLS m3u8)</label>
                <div class="flex gap-2.5">
                    <input type="text" id="url-input"
                        class="flex-1 bg-surface-light border border-white/10 rounded-lg px-4 py-3 text-sm font-mono focus:outline-none focus:border-primary"
                        value="https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8" placeholder="Nh·∫≠p URL stream...">
                    <button id="btn-load"
                        class="bg-primary hover:bg-primary-dark text-white font-semibold px-5 py-3 rounded-lg flex items-center gap-2 transition-colors">
                        <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M5 12h14M12 5l7 7-7 7" />
                        </svg>
                        T·∫£i
                    </button>
                </div>
            </div>

            <!-- Controls -->
            <div class="bg-surface rounded-xl p-4">
                <h3 class="text-xs text-white/60 uppercase tracking-wide mb-3">ƒêi·ªÅu khi·ªÉn Player</h3>
                <div class="grid grid-cols-3 sm:grid-cols-5 lg:grid-cols-9 gap-2.5">
                    <button
                        class="bg-surface-light hover:bg-primary border border-white/10 hover:border-primary rounded-lg p-3 text-xs flex flex-col items-center justify-center gap-1.5 transition-colors"
                        data-action="play">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M8 5v14l11-7z" />
                        </svg>
                        Play
                    </button>
                    <button
                        class="bg-surface-light hover:bg-primary border border-white/10 hover:border-primary rounded-lg p-3 text-xs flex flex-col items-center justify-center gap-1.5 transition-colors"
                        data-action="pause">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z" />
                        </svg>
                        Pause
                    </button>
                    <button
                        class="bg-surface-light hover:bg-primary border border-white/10 hover:border-primary rounded-lg p-3 text-xs flex flex-col items-center justify-center gap-1.5 transition-colors"
                        data-action="stop">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                            <rect x="6" y="6" width="12" height="12" />
                        </svg>
                        Stop
                    </button>
                    <button
                        class="bg-surface-light hover:bg-primary border border-white/10 hover:border-primary rounded-lg p-3 text-xs flex flex-col items-center justify-center gap-1.5 transition-colors"
                        data-action="rewind" data-args="[10]">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M11 18V6l-8.5 6 8.5 6zm.5-6l8.5 6V6l-8.5 6z" />
                        </svg>
                        -10s
                    </button>
                    <button
                        class="bg-surface-light hover:bg-primary border border-white/10 hover:border-primary rounded-lg p-3 text-xs flex flex-col items-center justify-center gap-1.5 transition-colors"
                        data-action="forward" data-args="[10]">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M4 18l8.5-6L4 6v12zm9-12v12l8.5-6L13 6z" />
                        </svg>
                        +10s
                    </button>
                    <button
                        class="bg-surface-light hover:bg-primary border border-white/10 hover:border-primary rounded-lg p-3 text-xs flex flex-col items-center justify-center gap-1.5 transition-colors"
                        data-action="toggleFullscreen">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z" />
                        </svg>
                        Fullscreen
                    </button>
                    <button
                        class="bg-surface-light hover:bg-primary border border-white/10 hover:border-primary rounded-lg p-3 text-xs flex flex-col items-center justify-center gap-1.5 transition-colors"
                        data-action="setVolume" data-args="[0.5]">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M3 9v6h4l5 5V4L7 9H3z" />
                        </svg>
                        Vol 50%
                    </button>
                    <button
                        class="bg-surface-light hover:bg-primary border border-white/10 hover:border-primary rounded-lg p-3 text-xs flex flex-col items-center justify-center gap-1.5 transition-colors"
                        data-action="setMuted" data-args="[true]">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                            <path
                                d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z" />
                        </svg>
                        Mute
                    </button>
                    <button
                        class="bg-surface-light hover:bg-primary border border-white/10 hover:border-primary rounded-lg p-3 text-xs flex flex-col items-center justify-center gap-1.5 transition-colors"
                        data-action="getState">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                            <path
                                d="M11 17h2v-6h-2v6zm1-15C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM11 9h2V7h-2v2z" />
                        </svg>
                        State
                    </button>
                </div>
            </div>

            <!-- State Display -->
            <div class="bg-surface rounded-xl p-4">
                <h3 class="text-xs text-white/60 uppercase tracking-wide mb-3">Tr·∫°ng th√°i Player</h3>
                <div class="grid grid-cols-3 gap-3">
                    <div class="bg-surface-light rounded-lg p-3 text-center">
                        <div class="text-lg font-semibold text-primary" id="state-time">0:00</div>
                        <div class="text-[11px] text-white/60 mt-1">Th·ªùi gian</div>
                    </div>
                    <div class="bg-surface-light rounded-lg p-3 text-center">
                        <div class="text-lg font-semibold text-primary" id="state-duration">0:00</div>
                        <div class="text-[11px] text-white/60 mt-1">T·ªïng</div>
                    </div>
                    <div class="bg-surface-light rounded-lg p-3 text-center">
                        <div class="text-lg font-semibold text-primary" id="state-status">---</div>
                        <div class="text-[11px] text-white/60 mt-1">Tr·∫°ng th√°i</div>
                    </div>
                </div>
            </div>

            <!-- Log -->
            <div class="bg-surface rounded-xl p-4">
                <div class="flex items-center justify-between text-xs text-white/60 uppercase tracking-wide mb-3">
                    <span>Console Log</span>
                    <button id="btn-clear-log"
                        class="bg-surface-light hover:bg-primary-dark px-2.5 py-1 rounded text-[11px] transition-all">Clear</button>
                </div>
                <div id="log-output"
                    class="bg-[#0a0a12] rounded-lg p-3 font-mono text-xs max-h-28 overflow-y-auto text-emerald-500">
                    <div class="text-blue-400">[VhPlyr Demo] Ready</div>
                </div>
            </div>
        </div>

        <!-- Sidebar -->
        <aside class="hidden lg:flex flex-col gap-4">
            <div class="bg-surface rounded-xl p-4 flex-1 flex flex-col">
                <h3 class="text-sm mb-3 flex items-center gap-2">
                    Chat
                    <span class="bg-primary px-2 py-0.5 rounded-full text-xs">128</span>
                </h3>
                <div
                    class="flex-1 min-h-[200px] bg-surface-light rounded-lg p-3 text-sm text-white/60 flex items-center justify-center">
                    üí¨ Chat demo - T√≠nh nƒÉng m√¥ ph·ªèng
                </div>
            </div>
        </aside>
    </main>

    <!-- Client SDK -->
    <script src="client-sdk.js"></script>
    <script>
        /**
         * VhPlyr Demo Controller (using VhPlyrClient SDK)
         */
            (function () {
                'use strict';

            const PLAYER_ORIGIN = 'https://vuihoc-edtech.github.io';
            const $ = (sel) => document.getElementById(sel);

            const elements = {
                playerIframe: $('player-iframe'),
                urlInput: $('url-input'),
                btnLoad: $('btn-load'),
                btnClearLog: $('btn-clear-log'),
                logOutput: $('log-output'),
                stateTime: $('state-time'),
                stateDuration: $('state-duration'),
                stateStatus: $('state-status'),
            };

            // Initialize SDK
            const player = new VhPlyrClient(elements.playerIframe, PLAYER_ORIGIN);

            // Logger
            const Log = {
                add(msg, type = '') {
                    const div = document.createElement('div');
                    div.className = type === 'info' ? 'text-blue-400' : type === 'error' ? 'text-red-400' : '';
                    div.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;
                    elements.logOutput.appendChild(div);
                    elements.logOutput.scrollTop = elements.logOutput.scrollHeight;
                },
                clear() {
                    elements.logOutput.innerHTML = '<div class="text-blue-400">[VhPlyr] Cleared</div>';
                }
            };

            // UI Helpers
            const UI = {
                formatTime(s) {
                    return `${Math.floor(s / 60)}:${Math.floor(s % 60).toString().padStart(2, '0')}`;
                },
                updateState(state) {
                    elements.stateTime.textContent = this.formatTime(state.currentTime || 0);
                    elements.stateDuration.textContent = this.formatTime(state.duration || 0);
                    elements.stateStatus.textContent = state.isPlaying ? '‚ñ∂Ô∏è' : state.isPaused ? '‚è∏Ô∏è' : '---';
                }
            };

            // SDK Action mapping (data-action -> SDK method)
            const actionMap = {
                play: () => player.play(),
                pause: () => player.pause(),
                stop: () => player.stop(),
                rewind: (args) => player.rewind(args[0]),
                forward: (args) => player.forward(args[0]),
                toggleFullscreen: () => player.toggleFullscreen(),
                setVolume: (args) => player.setVolume(args[0]),
                setMuted: (args) => player.setMuted(args[0]),
                getState: () => player.getState(),
            };

            // Control button events
            document.querySelectorAll('[data-action]').forEach(btn => {
                btn.addEventListener('click', async () => {
                    const action = btn.dataset.action;
                    const args = btn.dataset.args ? JSON.parse(btn.dataset.args) : [];

                    Log.add(`‚Üí ${action}(${args.join(', ')})`);

                    try {
                        const handler = actionMap[action];
                        if (handler) {
                            const result = await handler(args);
                            if (result !== undefined) {
                                Log.add(`‚Üê [${action}] ${JSON.stringify(result).substring(0, 60)}`);
                                if (action === 'getState') UI.updateState(result);
                            }
                        }
                    } catch (err) {
                        Log.add(`‚úó ${action} error: ${err}`, 'error');
                    }
                });
            });

            // Load URL
            function loadUrl(url) {
                if (!url) return;
                Log.add(`Loading: ${url.substring(0, 40)}...`, 'info');
                elements.playerIframe.src = `${PLAYER_ORIGIN}/vh_plyr/?url=${encodeURIComponent(url)}`;
            }

            elements.btnLoad.addEventListener('click', () => loadUrl(elements.urlInput.value.trim()));
            elements.btnClearLog.addEventListener('click', Log.clear);
            elements.urlInput.addEventListener('keypress', (e) => e.key === 'Enter' && loadUrl(elements.urlInput.value.trim()));

            // Listen to SDK events
            player.on('*', (eventName, data) => {
                Log.add(`‚ö° ${eventName}: ${JSON.stringify(data || {}).substring(0, 50)}`);
            });

            // Auto refresh state every 2s
            setInterval(async () => {
                try {
                    const state = await player.getState();
                    UI.updateState(state);
                } catch { /* ignore timeout during loading */ }
            }, 2000);

            Log.add('VhPlyrClient SDK initialized', 'info');
        })();
    </script>
</body>
</html>